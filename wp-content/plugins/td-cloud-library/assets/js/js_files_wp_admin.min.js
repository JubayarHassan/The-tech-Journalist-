var tdbApi={};
(function(){tdbApi={run:function(a){void 0===a.post&&(a.post={});void 0===a.done&&tdLog.kill("Missing done");void 0===a.wpNonce&&tdLog.kill("Missing wpNonce");void 0===a.cloudEndPoint&&tdLog.kill("Missing endpoint");void 0===a.error&&(a.error=function(a){console.log("%cAPI ERROR","background: #ffaa00; color: #ffffff; padding:3px 6px",a)});return jQuery.ajax({timeout:5E4,type:"POST",url:tdbApi._getRestEndPoint(a.cloudEndPoint,"uuid="+tdbApi._getUniqueID()),beforeSend:function(b){b.setRequestHeader("X-WP-Nonce",a.wpNonce)},
cache:!1,data:a.post,dataType:"json",statusCode:{404:function(){console.log("ERROR: 404 not found")},500:function(){console.log("ERROR: 500 server error")}},success:function(b,c,d){console.group("API: "+a.cloudEndPoint);console.log("Post: ",a.post);console.log("Reply: ",b);console.groupEnd();null===b?a.error([{type:"AJAX ERROR",message:"Empty response received from server.",debug_data:{endpoint:a.cloudEndPoint,request:d}}]):void 0!==b.api_reply?(void 0!==b.api_reply.error&&Array.isArray(b.api_reply.error)?
b.api_reply.error.unshift({type:"Proxy ERROR",message:"The templates API server responded with an error.",debug_data:""}):void 0!==b.api_reply.fatal_error&&(b.api_reply.error=[{type:"Proxy ERROR",message:"The templates API server responded with an error.",debug_data:b.api_reply.fatal_error}]),void 0!==b.api_reply.error?a.error(b.api_reply.error):a.done(b.api_reply)):a.done(b)},error:function(b,c,d){a.error([{type:"AJAX ERROR",message:"Invalid reply from server endpoint.",debug_data:{endpoint:a.cloudEndPoint,
request:b}}]);void 0!==b.responseText?console.log("%cAPI ERROR "+a.cloudEndPoint,"background: #ffaa00; color: #ffffff; padding:3px 6px","Error - check for php warnings:",b.responseText):console.log("%cAPI ERROR "+a.cloudEndPoint,"background: #ffaa00; color: #ffffff; padding:3px 6px","Error - check for php warnings:",b,c,d)}})},cloudRun:function(a){void 0===a.post&&(a.post={});void 0===a.error&&(a.error=function(a){console.log("%cAPI ERROR","background: #ffaa00; color: #ffffff; padding:3px 6px; margin-bottom:4px; display:inline-block",
a)});void 0===a.cloudError&&(a.cloudError=function(a){console.log("%cCLOUD API ERROR","background: #d22020; color: #ffffff; padding:3px 6px; margin-bottom:4px; display:inline-block",a)});return tdbApi.run({wpNonce:window.tdb_globals.wpRestNonce,cloudEndPoint:"td-cloud-library/td_cloud_proxy",post:{cloudPost:a.cloudPost,cloudEndPoint:a.cloudEndPoint},done:function(b){void 0!==b.cloudError?(a.cloudError(b.cloudError),console.groupEnd()):a.done(b)},error:function(b){a.error(b)}})},workCloudRun:function(a){void 0===
a.post&&(a.post={});void 0===a.error&&(a.error=function(a){console.log("%cAPI ERROR","background: #ffaa00; color: #ffffff; padding:3px 6px; margin-bottom:4px; display:inline-block",a)});void 0===a.cloudError&&(a.cloudError=function(a){console.log("%cCLOUD API ERROR","background: #d22020; color: #ffffff; padding:3px 6px; margin-bottom:4px; display:inline-block",a)});return tdbApi.run({wpNonce:window.tdb_globals.wpRestNonce,cloudEndPoint:"td-cloud-library/td_cloud_proxy_work_cloud",post:{cloudPost:a.cloudPost,
cloudEndPoint:a.cloudEndPoint},done:function(b){void 0!==b.cloudError?(a.cloudError(b.cloudError),console.groupEnd()):a.done(b)},error:function(b){a.error(b)}})},_getRestEndPoint:function(a,b){return _.isEmpty(window.tdb_globals.permalinkStructure)?window.tdb_globals.wpRestUrl+a+"&"+b:window.tdb_globals.wpRestUrl+a+"?"+b},_getUniqueID:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}})();
"undefined"===typeof window.tdcPostSettings&&(window.tdcPostSettings={tdbTemplateType:"all"});
if(window.tdbVue&&"undefined"!==typeof window.tdbVue.router){var eventHub=new Vue;Vue.component("image-links",{template:'\n            <a :class="classes" :href="link">{{text}}</a>\n        ',props:{classes:[],link:"",text:""}});window.eventHub.$on("refresh-global-colors",function(){jQuery.ajax({url:td_ajax_url,type:"post",data:{action:"tdc_wm_global_colors_update",td_magic_token:tdc_wm_global_colors_nonce},success:function(a){a=JSON.parse(a);window.tdc_wm_global_colors=a.tdc_wm_global_colors;var b=
":root {";Object.entries(a.tdc_wm_global_colors).forEach(function(a){b+="--"+a[0].replace(/_/g,"-")+":"+a[1].color+";"});b+="}";a=jQuery("style#tdb-global-colors");a.length&&a.html(b);a=window.document.getElementById("tdc-live-iframe");null!==a&&(a=jQuery("style#tdb-global-colors",a.contentWindow.document),a.length&&a.html(b))},error:function(a,b,c){console.log("%c"+c,"color: #dc2121c7")}})});new Vue({el:"#tdb-modal",router:window.tdbVue.router})}
window.tdbVueManager&&"undefined"!==typeof window.tdbVueManager.router&&new Vue({el:"#tdb-modal-website-manager",router:window.tdbVueManager.router});(function(){jQuery('#menu-posts-tdb_templates a[href$="post-new.php?post_type=tdb_templates"], #wp-admin-bar-new-tdb_templates a[href$="post-new.php?post_type=tdb_templates"]').hide()})();
(function(){jQuery(".post-type-tdb_templates .page-title-action, .td-open-cloud-library").addClass("page-title-action-show").on("click",function(a){a.preventDefault();window.tdbVue.router.push({name:"loadRoute"})})})();
function tdbCategoryTemplateSelect(){var a=jQuery("#td-panel-categories"),b=a.find('select[name="td_option[tdb_category_template]"]'),c=a.find(".td_panel_box_category_global_settings");""===b.val()?a.find("div[class*='td_panel_box_category_individual_settings_cat_']").each(function(){var a=jQuery(this),b=a.children(".td-box-header").eq(0).data("panel-ajax-params").category_id;b=a.find('select[name="td_category['+b+'][tdb_category_template]"]');""!==b.val()&&("theme_templates"===b.val()?a.removeClass("hide-settings"):
!1===a.hasClass("td-box-close")&&a.addClass("hide-settings"))}):(c.addClass("hide-settings"),a.find("div[class*='td_panel_box_category_individual_settings_cat_']").each(function(){var a=jQuery(this),b=a.children(".td-box-header").eq(0).data("panel-ajax-params").category_id;"theme_templates"===a.find('select[name="td_category['+b+'][tdb_category_template]"]').val()?a.removeClass("hide-settings"):!1===a.hasClass("td-box-close")&&a.addClass("hide-settings")}));!1===b.hasClass("change-event-bound")&&
(b.addClass("change-event-bound"),b.on("change",function(b){""===jQuery(this).val()?(c.removeClass("hide-settings"),a.find("div[class*='td_panel_box_category_individual_settings_cat_']").each(function(){var a=jQuery(this),b=a.children(".td-box-header").eq(0).data("panel-ajax-params").category_id;b=a.find('select[name="td_category['+b+'][tdb_category_template]"]');"theme_templates"===b.val()?a.removeClass("hide-settings"):""===b.val()&&!1===a.hasClass("td-box-close")&&a.removeClass("hide-settings")})):
(c.addClass("hide-settings"),a.find("div[class*='td_panel_box_category_individual_settings_cat_']").each(function(){var a=jQuery(this),b=a.children(".td-box-header").eq(0).data("panel-ajax-params").category_id;"theme_templates"===a.find('select[name="td_category['+b+'][tdb_category_template]"]').val()?a.removeClass("hide-settings"):!1===a.hasClass("td-box-close")&&a.addClass("hide-settings")}))}));a.find("div[class*='td_panel_box_category_individual_settings_cat_']").each(function(){var a=jQuery(this),
c=a.children(".td-box-header").eq(0).data("panel-ajax-params").category_id,e=a.find('select[name="td_category['+c+'][tdb_category_template]"]');!1===e.hasClass("change-event-bound")&&(e.addClass("change-event-bound"),e.on("change",function(c){""===e.val()?""===b.val()?a.removeClass("hide-settings"):a.addClass("hide-settings"):"theme_templates"===e.val()?a.removeClass("hide-settings"):!1===a.hasClass("td-box-close")&&a.addClass("hide-settings")}))})}
function tdbHeaderTemplateSelect(){var a=jQuery("#td-panel-header"),b=a.find('select[name^="td_option[tdb_header_template"]');b.length&&(""===b.val()?a.removeClass("hide-settings"):a.addClass("hide-settings"));b.off().on("change",function(){tdbHeaderTemplateSelect()})}
function tdbFooterTemplateSelect(){var a=jQuery("#td-panel-footer"),b=a.find('select[name^="td_option[tdb_footer_template"]');b.length&&(""===b.val()?a.removeClass("hide-settings"):a.addClass("hide-settings"));b.off().on("change",function(){tdbFooterTemplateSelect()})}
jQuery(".tdb-duplicate-template").on("click",function(a){a.preventDefault();a=jQuery("#the-list");jQuery("tr#post-"+jQuery(this).data("post-id")).addClass("tdb-duplicate-working");a.addClass("tdb-disable-list");tdbApi.run({wpNonce:window.tdb_globals.wpRestNonce,cloudEndPoint:"td-cloud-library/new_template",post:{postId:jQuery(this).data("post-id"),templateType:jQuery(this).data("template-type"),templateName:jQuery(this).data("template-name"),duplicateTemplate:!0},done:function(a){location.reload()},
error:function(a){console.log("td-cloud-library/new_template ( duplicate template ) - ERROR",a)}})});
jQuery(".td-debug-area").length&&(jQuery.ajax({type:"POST",url:td_ajax_url,data:{_nonce:window.tdb_globals.wpRestNonce,action:"tdb_work_cloud",option:"get"},success:function(a,b,c){console.log(a);b="";a=JSON.parse(a);"undefined"!==typeof a[0].checked&&"true"==a[0].checked&&(b="checked");jQuery(".td-debug-area").append('<table id="td-log1-table" class="widefat td-system-status-table td-log-table" cellspacing="0"><tbody><tr><td><p class="td-work-cloud-ip">Enable/disable work-cloud</p></td></tr><tr><td><div class="td-admin-checkbox td-small-checkbox"><input type="checkbox" class="td-work-cloud" '+b+
'></div></td></tr><tr><td><div class="td-work-info"></div></td></tr></tbody></table>')},error:function(a,b,c){}}),jQuery("body").on("click",".td-work-cloud",function(){var a=jQuery(this);jQuery.ajax({type:"POST",url:td_ajax_url,data:{_nonce:window.tdb_globals.wpRestNonce,action:"tdb_work_cloud",option:"set",value:a.is(":checked")},success:function(a,c,d){window.location.reload()},error:function(a,c,d){}})}).on("click",".td-work-cloud-ip",function(){jQuery.ajax({type:"POST",url:td_ajax_url,data:{_nonce:window.tdb_globals.wpRestNonce,
action:"tdb_work_cloud",option:"ip"},success:function(a,b,c){console.log(a);a=JSON.parse(a);"undefined"!==typeof a[0].ip&&jQuery(".td-debug-area .td-work-info").html(a[0].ip)},error:function(a,b,c){}})}));var tdbCloudTemplates={};
(function(a,b){tdbCloudTemplates={init:function(){window.tdbCloudTemplatesVue&&"undefined"!==typeof window.tdbCloudTemplatesVue.router&&a("#tdb-cloud-templates").length&&new Vue({el:"#tdb-cloud-templates",router:window.tdbCloudTemplatesVue.router})}};tdbCloudTemplates.init()})(jQuery,_);
